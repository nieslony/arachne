<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <p:dialog header="Access what"
              dynamic="true"
        id="dlgEditWhat"
        onShow="#{editWhat.onShow()}"
        widgetVar="dlgEditWhat"
        >
        <h:form id="formEditWhat">
            <p:selectOneRadio value="#{editFirewallSettings.editWhat.type}"
                              layout="custom"
                              id="whatType">
                <f:selectItem itemValue="Everything" />
                <f:selectItem itemLabel="Service" itemValue="Service"/>
                <f:selectItem itemValue="PortProtocol"/>
                <f:selectItem itemValue="PortRangeProtocol"/>
                <f:selectItem itemValue="PortListProtocol"/>
                <f:ajax render="service portProtocol portRangeProtocol portListProtocol"/>
            </p:selectOneRadio>

            <h:panelGrid columns="3">
                <p:radioButton for="whatType" itemIndex="0" id="rbEverything"/>
                <p:outputLabel for="rbEverything" value="Everything"/>
                <h:outputText value=""/>

                <p:radioButton for="whatType" itemIndex="1" id="rbService"/>
                <p:outputLabel for="rbService" value="Service"/>
                <p:selectOneMenu disabled='#{editFirewallSettings.editWhat.type != "Service"}'
                                 id="service"
                                 filter="true"
                                 converter="firewallDServiceConverter"
                                 value="#{editFirewallSettings.editWhat.service}"
                                 >
                    <f:selectItems value="#{firewallDServices.services}"
                                   var="s"
                                   itemLabel="#{s.shortDescription}"
                                   itemValue="#{s}"
                                   />
                </p:selectOneMenu>

                <p:radioButton for="whatType" itemIndex="2" id="rbPortProtocol"/>
                <p:outputLabel for="rbPortProtocol" value="Port and Protocol"/>
                <p:outputPanel id="portProtocol">
                    <p:spinner min="1" max="65535" size="5"
                               disabled='#{editFirewallSettings.editWhat.type != "PortProtocol"}'
                               value="#{editFirewallSettings.editWhat.port}"/>
                    <h:outputText value=" / "/>
                    <p:selectOneMenu value="#{editFirewallSettings.editWhat.protocol}"
                                     disabled='#{editFirewallSettings.editWhat.type != "PortProtocol"}' >
                        <f:selectItem itemLabel="Tcp" itemValue="TCP"/>
                        <f:selectItem itemLabel="Udp" itemValue="UDP"/>
                    </p:selectOneMenu>
                </p:outputPanel>

                <p:radioButton for="whatType" itemIndex="3" id="rbPortRangeProtocol"/>
                <p:outputLabel for="rbPortRangeProtocol" value="Port range and protocol"/>
                <p:outputPanel id="portRangeProtocol">
                    <p:spinner min="1" max="65535" size="5"
                               disabled='#{editFirewallSettings.editWhat.type != "PortRangeProtocol"}'
                               value="#{editFirewallSettings.editWhat.portFrom}"/>
                    <h:outputText value=" - "/>
                    <p:spinner min="1" max="65535" size="5"
                               disabled='#{editFirewallSettings.editWhat.type != "PortRangeProtocol"}'
                               value="#{editFirewallSettings.editWhat.portTo}"/>
                    <h:outputText value=" / "/>
                    <p:selectOneMenu value="#{editFirewallSettings.editWhat.protocol}"
                                     disabled='#{editFirewallSettings.editWhat.type != "PortRangeProtocol"}'>
                        <f:selectItem itemLabel="Tcp" itemValue="TCP"/>
                        <f:selectItem itemLabel="Udp" itemValue="UDP"/>
                    </p:selectOneMenu>
                </p:outputPanel>

                <p:radioButton for="whatType" itemIndex="4" id="rbPortListProtocol"/>
                <p:outputLabel for="rbPortListProtocol" value="Port list and Protocol"/>
                <p:outputPanel id="portListProtocol">
                    <p:inputText disabled='#{editFirewallSettings.editWhat.type != "PortListProtocol"}'
                                 value="#{editFirewallSettings.editWhat.ports}">
                        <p:keyFilter regEx="/[0-9 ,;]/"/>
                    </p:inputText>
                    <h:outputText value=" / "/>
                    <p:selectOneMenu value="#{editFirewallSettings.editWhat.protocol}"
                                     disabled='#{editFirewallSettings.editWhat.type != "PortListProtocol"}'>
                        <f:selectItem itemLabel="Tcp" itemValue="TCP"/>
                        <f:selectItem itemLabel="Udp" itemValue="UDP"/>
                    </p:selectOneMenu>
                </p:outputPanel>
            </h:panelGrid>

            <p:commandButton value="OK"
                             action="#{editFirewallSettings.editWhat.onOk}"
                             update="formEditFirewallEntry dlgEditWhat"/>
            <p:commandButton value="Cancel"
                             action="#{editFirewallSettings.editWhat.onCancel}"/>
        </h:form>
    </p:dialog>
</ui:composition>